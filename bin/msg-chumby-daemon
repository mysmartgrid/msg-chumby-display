#!/usr/bin/env ruby

libpath=File.join(File.dirname(__FILE__), '..', 'lib')
$:.unshift << libpath 
puts "Using libraty path #{$:.join(":")}" 
require 'rubygems'
require 'lib/msg-chumby-daemon.rb'

reading_cache=MSG_Chumby::Reading_Cache.new();
$server=MSG_Chumby::HTTP_XML_Server.new("127.0.0.1", 3000, reading_cache);

def startAll
  $server.start();
  $server.join();
end

def stopAll
  $server.stop();
  exit;
end

trap("INT") {stopAll();}
trap("KILL") {stopAll();}
startAll();
